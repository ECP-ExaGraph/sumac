Need to debug/test
Added optimizations but barebones